
<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Rason&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Rason&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Rason&#39;s Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rason&#39;s Blog">
  
    <link rel="alternative" href="/atom.xml" title="Rason&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head></html>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Rason&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name="tn" type="hidden" value="bds">
          <input name="cl" type="hidden" value="3">
          <input name="ct" type="hidden" value="2097152">
          <input type="hidden" name="si" value="yoursite.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main">
  
    <article id="post-Concurrency-control" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/13/Concurrency-control/" class="article-date">
  <time datetime="2017-09-13T01:47:35.000Z" itemprop="datePublished">2017-09-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Concurrency/">Concurrency</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/13/Concurrency-control/">并发控制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在信息技术和计算机科学领域，特别是在计算机编程，操作系统，多处理器和数据库领域，并发控制可以<strong>确保并发操作的正确结果</strong>。</p>
<p>计算机系统，软件和硬件都由模块或组件组成。每个组件被设计为正确地操作，即，服从或满足某些一致性规则。当组件通过<strong>消息传递</strong>或<strong>共享访问的数据</strong>（在存储器或存储器中）同时进行操作时，某个组件的一致性可能被另一个组件破坏。</p>
<p>并发控制领域提供规则，方法，设计方法和理论，以保持组件在交互时并发运行的一致性，从而保持整个系统的一致性和正确性。在系统中引入并发控制意味着对一些操作进行了限制，这通常会导致某些性能上的下降。操作一致性和正确性应尽可能高效地实现，而不会将性能降低到合理的水平以下。与简单的顺序算法相比，并发控制可能需要大量额外的复杂性和并发算法的开销。</p>
<h2 id="数据库中的并发控制"><a href="#数据库中的并发控制" class="headerlink" title="数据库中的并发控制"></a>数据库中的并发控制</h2><p>数据库管理系统，其他事务对象以及相关的分布式应用程序中的并发控制可以确保数据库事务同时执行，而不会违反各数据库的数据完整性。因此，在两个数据库事务或多个数据库事务或多个数据库事务随时间重叠执行的任何系统中，并发控制是正确性的基本要素，可以访问相同的数据。前人提出了一个完善的数据库系统并发控制理论：<a href="https://en.wikipedia.org/wiki/Serializability" target="_blank" rel="noopener">序列化理论</a>，可以有效地设计和分析并发控制方法和机制。</p>
<p>为了确保正确性，DBMS通常保证只生成<a href="https://en.wikipedia.org/wiki/Serializability" target="_blank" rel="noopener">可串行化</a>的事务计划，除非有意放宽序列化以提高性能，而且仅在应用程序正确性不受损害的情况下。为了在事务调度失败（中止）的情况下维持正确性还需要具有<a href="https://en.wikipedia.org/wiki/Serializability#Correctness_-_recoverability" target="_blank" rel="noopener">可恢复</a>（从中止）属性。DBMS还保证不会丢失提交的事务的影响，并且相关数据库中没有受中止（回滚）事务的影响。</p>
<h2 id="数据库事务与ACID原则"><a href="#数据库事务与ACID原则" class="headerlink" title="数据库事务与ACID原则"></a>数据库事务与ACID原则</h2><p>数据库事务是工作单元，通常在数据库中封装多个操作（例如，读取数据库对象，写入，获取锁定等）。每个数据库事务都遵循以下规则：</p>
<ul>
<li><p><strong>原子性</strong>：事务中的每一项操作是一个整体，要么全部完成，要么全部放弃。</p>
</li>
<li><p><strong>一致性</strong>：每个事务必须使数据库保持一致（正确）状态，即维护数据库的预定完整性规则（对数据库对象之间的约束）。事务必须将数据库从一个一致的状态转变为另一个一致状态（然而，程序员有责任确保事务本身是正确的，即正确地执行它打算执行的操作（从应用程序的角度来看视图），而预定义的完整性规则由DBMS执行）。</p>
</li>
<li><p><strong>隔离性</strong>：事务之间不能相互干扰（作为其执行的最终结果）。此外，通常（根据并发控制方法），未完成的事务的影响对于另一个事务来说甚至不可见。 <strong>提供隔离性是并发控制的主要目标</strong>。</p>
</li>
<li><p><strong>持久性</strong>：成功（提交）事务的影响是持久的。</p>
</li>
</ul>
<h2 id="为什么需要并发控制？"><a href="#为什么需要并发控制？" class="headerlink" title="为什么需要并发控制？"></a>为什么需要并发控制？</h2><p>如果事务按顺序执行，即顺序地在时间上不重叠，则不存在事务并发性。然而，如果以不受控制的方式允许具有交织操作的并发事务，则可能会发生一些意外的不期望的结果，例如：</p>
<ul>
<li>更新丢失问题：第二个事务在由第一个并发事务写入的第一个值之上写入数据项（数据）的第二个值。</li>
<li>脏读问题：事务读取由稍后回滚的事务写入的值。</li>
<li>不正确的摘要问题：当一个事务对重复数据项的所有实例的值进行摘要总结，但第二个事务更新了该数据项的某些实例。</li>
</ul>
<p>大多数高性能事务系统需要并发运行事务以满足其性能要求。因此，没有并发控制，这样的系统既不能提供正确的结果也不能保持数据库的一致性。</p>
<h2 id="并发控制机制"><a href="#并发控制机制" class="headerlink" title="并发控制机制"></a>并发控制机制</h2><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>并发控制机制主要分类如下：</p>
<ul>
<li><p>乐观并发控制：延迟检查事务是否满足隔离和其他完整性规则（例如，可串行化和可恢复性），直到其结束，而不会阻止其任何（读取和写入）操作。如果规则在其提交时被违反，则中止事务。中断的事务立即重新启动并重新执行，这导致了明显的开销（而不是执行到最后一次）。如果不是太多的事务被中止，那么乐观通常是一个很好的策略。</p>
</li>
<li><p>悲观并发控制：阻塞可能会破坏完整性等规则的事务。阻塞操作通常会带来性能上的下降。</p>
</li>
<li><p>半乐观并发控制：一些情况下阻塞，一些情况下不阻塞。</p>
</li>
</ul>
<p>不同的类别提供不同的性能，即不同的平均事务完成率（吞吐量），这取决于事务类型的组合，并行度的计算水平和其他因素。阻塞，死锁和中止都会导致性能下降，从而导致类别之间的权衡。</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>并发控制有许多方法。它们中的大多数可以在上述主要类别中实现。主要的方法，有各种各样的变体，在某些情况下可能重叠或组合，它们是：</p>
<ul>
<li><p>1.锁（例如<a href="https://en.wikipedia.org/wiki/Two-phase_locking" target="_blank" rel="noopener">二阶段锁</a>）：在数据上加锁控制其访问。</p>
</li>
<li><p>2.<a href="https://en.wikipedia.org/wiki/Serializability#Testing_conflict_serializability" target="_blank" rel="noopener">优先图检测</a>：检查调度图是否形成一个回路，可以通过中止某个事务来中止。</p>
</li>
<li><p>3.<a href="https://en.wikipedia.org/wiki/Timestamp-based_concurrency_control" target="_blank" rel="noopener">时间戳顺序</a>：在事务上标记时间戳，然后通过时间戳先后顺序来控制或者检查数据访问。</p>
</li>
<li><p>4.<a href="https://en.wikipedia.org/wiki/Commitment_ordering" target="_blank" rel="noopener">提交顺序</a>：控制或检查事务提交的时间顺序与它们各自的优先级一致。</p>
</li>
</ul>
<p>与上述方法一起使用的其他主要并发控制类型包括：</p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control" target="_blank" rel="noopener">多版本并发控制</a>（MVCC）:通过每次写对象时生成一个数据库对象的新版本来增加并发性和性能，并根据调度方法允许对几个最后相关版本（每个对象）的事务读操作。</p>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Index_locking" target="_blank" rel="noopener">索引并发控制</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/09/13/Concurrency-control/" data-id="cjs45t43y001kfn9fe8ufokag" class="article-share-link" data-share="baidu" data-title="并发控制">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Concurrency/">Concurrency</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Two-phase-locking" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/11/Two-phase-locking/" class="article-date">
  <time datetime="2017-09-11T01:12:28.000Z" itemprop="datePublished">2017-09-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Concurrency/">Concurrency</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/11/Two-phase-locking/">Two-phase locking</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>两阶段锁(Two-phase locking)是一种处理并发控制的方法，跟两阶段提交不一样，两阶段提交用于处理分布式事务或者数据库的原子提交问题。</p>
<p>在数据库和事务处理中，两阶段锁是一种在并发控制中保证<strong>可串行化</strong>的方法。两阶段锁协议利用事务对数据应用锁机制，这可能阻塞其他事务在该事务的生命周期中访问相同的数据。</p>
<p>在两阶段锁协议中，锁被应用与两个阶段：</p>
<ul>
<li>1.扩展阶段：只能加锁，不能释放锁。</li>
<li>2.收缩阶段：只能释放锁，不能加锁。</li>
</ul>
<p>在基本的协议中一般用到两种类型的锁：共享锁和排它锁。而在改进的协议中，可能会应用更多类型的锁。使用锁来阻塞进程，在两个互相阻塞的事务中，两阶段锁可能会导致死锁。</p>
<h2 id="数据访问锁"><a href="#数据访问锁" class="headerlink" title="数据访问锁"></a>数据访问锁</h2><p>锁是与共享资源，比如基本类型的数据项，数据库中的一行数据或者内存页相关联的<strong>系统对象</strong>。在数据库中，访问数据对象之前可能需要先获得在该数据对象上的锁(数据访问锁)。</p>
<p>正确地使用锁可以防止其他事务在共享资源上进行不被期望，不正确或者不一致的操作。当一个事务需要访问另一个事务持有锁的数据对象，系统会检测数据对象的锁是否已经被持有和锁的类型。如果现有的锁类型不允许进行并发访问，则该尝试访问的事务会被阻止。</p>
<p>实际上，对象上的锁定并不直接阻止事务在对象上的操作，而是阻止该事务从同一对象获取另一个锁，在执行此操作之前需要由事务持有。 </p>
<p>两种类型的锁：</p>
<ul>
<li><strong>写锁(排它锁)</strong>：对数据对象进行写(插入/修改/删除)操作之前，写锁由事务与数据对象相关联。</li>
<li><strong>读锁(共享锁)</strong>：读取数据之前，读锁由事务与数据对象相关联。</li>
</ul>
<p>这两种锁的相互关系和阻塞行为如下：</p>
<ul>
<li>一个事务获取了数据对象的写锁，另一个事务在该对象的写操作会被阻塞。</li>
<li>一个事务获取了数据对象的写锁，另一个事务在该对象的读操作会被阻塞。</li>
<li>一个事务获取了数据对象的读锁，另一个事务在该对象的写操作会被阻塞。</li>
<li>一个事务获取了数据对象的读锁，另一个事务在该对象的读操作不会被阻塞。</li>
</ul>
<p>如果第一个锁阻塞另一个锁，那么这两个锁称为不兼容，否则称为兼容。</p>
<table>
<thead>
<tr>
<th>Lock type</th>
<th>read-lock</th>
<th>write-lock</th>
</tr>
</thead>
<tbody>
<tr>
<td>read-lock</td>
<td></td>
<td>X</td>
</tr>
<tr>
<td>write-lock</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<h2 id="两阶段锁和它的特殊情况"><a href="#两阶段锁和它的特殊情况" class="headerlink" title="两阶段锁和它的特殊情况"></a>两阶段锁和它的特殊情况</h2><h3 id="两阶段锁"><a href="#两阶段锁" class="headerlink" title="两阶段锁"></a>两阶段锁</h3><p>根据两阶段锁定协议，一个事务在事务的执行过程中处理其两个不同的连续阶段的锁：</p>
<ul>
<li>1.<strong>扩展阶段</strong>：锁只能被获得，不能被释放。</li>
<li>2.<strong>收缩阶段</strong>：锁只能被释放，不能被获得。</li>
</ul>
<p>两相锁定规则可以归纳为：不要在释放锁之后获取锁。对于具有遵守此规则的事务，可以保证串行化属性。</p>
<p>通常，在不明确事务的第一阶段何时结束的情况下，在事务最终完成和请求提交之后一次性释放锁会比较安全。</p>
<h3 id="保守两阶段锁"><a href="#保守两阶段锁" class="headerlink" title="保守两阶段锁"></a>保守两阶段锁</h3><p>保守两阶段锁与两阶段锁的不同之处就是在事务开始之前先获得所有的锁。这是为了确保事务能够持有所需要的锁而不被阻塞。保守两阶段锁可以避免死锁。</p>
<h3 id="严格两阶段锁"><a href="#严格两阶段锁" class="headerlink" title="严格两阶段锁"></a>严格两阶段锁</h3><p>为了符合S2PL协议，事务需要符合2PL，并且只有在结束之后释放其写锁，即被提交或中止。另一方面，读锁在阶段2期间定期释放。</p>
<h2 id="可串行化"><a href="#可串行化" class="headerlink" title="可串行化"></a>可串行化</h2><p>上面提到二阶段锁是保证可串行化属性的的方法。那么什么是可串行化？</p>
<p>在理解可串行化之前我们首先要明白什么叫调度，<strong>调度（schedule）</strong>指数据库要执行多项事务，每项事务包括好几条指令，先执行什么指令后执行什么指令的安排。</p>
<p>但是指令的安排顺序（即调度）不同，事务的执行结果也不同。我们必须有一个标准来判断某种调度是否正确。这个标准就是事务串行——先执行事务1的所有指令，再执行事务2的所有指令——后的结果。如果调度结果与串行结果相同，则调度正确；反之则错误。此概念与操作系统中多线程的执行类似。</p>
<p>对于正确的调度，我们给它一个形容词，说此调度是可串行的（Serializable）。可串行的是英文直译，更准确的词可以是“串行等价的”，即该调度的结果与事务串行的结果是相等的。</p>
<ul>
<li>如果两项事务只是读数据，则指令的执行顺序是无关紧要的；</li>
<li>如果两项事务读写不同的数据，则指令的执行顺序是无关紧要的；</li>
<li>如果两项事务读写同一条数据，则指令的执行顺序是重要的。我们把这两项事务称为冲突的事务。</li>
</ul>
<p>第（1）（2）两类事务的任何调度，都是串行等价的。对于第（3）类事务，如果调度正确，我们可以说此调度是冲突可串行的（Conflict Serializable），更准确的说法可以是“冲突串行等价的”，表示该调度的结果与冲突（的事务）串行的结果是相等的。冲突串行等价的是串行等价的的子类。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/09/11/Two-phase-locking/" data-id="cjs45t45c0056fn9f7iolafei" class="article-share-link" data-share="baidu" data-title="Two-phase locking">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Concurrency/">Concurrency</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-cluster-node" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/28/elasticsearch-cluster-node/" class="article-date">
  <time datetime="2017-08-28T07:56:39.000Z" itemprop="datePublished">2017-08-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/28/elasticsearch-cluster-node/">Elasticsearch节点</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>当我们启动一个Elasticsearch实例时，就是在启动一个节点。一系列连接在一起的节点就称为一个集群。如果你运行单一节点的Elasticsearch ，那么你就拥有了一个只有一个节点的集群。</p>
<p>默认情况下，群集中的每个节点都可以处理HTTP请求和传输通信。 传输层专用于节点和Java TransportClient之间的通信; HTTP层仅由外部REST客户端使用。</p>
<p>所有节点都知道集群中其它节点的情况并且可以转发客户端请求到适当的节点。除此之外，每个节点都可以充当一个或者角色：</p>
<ul>
<li><p><strong>主节点</strong></p>
<p>  节点的node.master属性被设置为true(默认),使得它有资格被选举为主节点，用于控制集群。</p>
</li>
<li><p><strong>数据节点</strong></p>
<p>  节点的node.data属性被设置为true(默认)。数据节点持有数据并处理数据相关的操作，比如CRUD，搜索和聚合。</p>
</li>
<li><p><strong>Ingest节点</strong></p>
<p>  节点的node.ingest属性被设置为true(默认)。可以采用流水线的方式对索引的文档进行加工处理。这个节点的负载会比较大，使用专用的节点作为Ingest，并且将主节点和数据节点的node.ingest属性设置为false是一个很好的方式。</p>
</li>
<li><p><strong>Tribe节点</strong></p>
<p>  通过<code>tribe.*</code>配置，是一种仅用于协调的特殊节点。可以连接到多个集群，并在所有连接的集群中执行搜索和其他操作。</p>
</li>
</ul>
<p>默认情况下，一个节点是不仅是具有主资格的节点，还是数据节点，外加可以通过Ingest流水线对文档进行预处理。这对于一个小集群来说非常方便，但是随着集群的增长，将主节点和数据节点单独分开会变得越来越重要。</p>
<blockquote>
<p><strong>协调节点</strong></p>
</blockquote>
<blockquote>
<p>请求(比如搜索请求或者批量索引请求)可能会包含位于不同节点的数据.例如，一个搜索请求，由接收客户端请求的节点协调分两个阶段执行——这个节点就是协调节点。</p>
</blockquote>
<blockquote>
<p>分散阶段，协调节点将请求转发到保存数据的数据节点。每个数据节点本地执行请求然后返回结果到协调节点。在聚集阶段，协调节点将每个数据节点的结果聚合为一个全局的结果集。</p>
</blockquote>
<blockquote>
<p>每个节点都隐式作为协调节点。这意味这如果一个节点的node.master,node.data,node.ingest三个属性都设为false，那么它就只能作为一个协调节点，协调功能是没法禁用的。这样的一个节点需要有足够的内存和CPU才能处理聚合阶段。</p>
</blockquote>
        
          <p class="article-more-link">
            <a href="/2017/08/28/elasticsearch-cluster-node/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/08/28/elasticsearch-cluster-node/" data-id="cjs45t45k0063fn9f09alt2h6" class="article-share-link" data-share="baidu" data-title="Elasticsearch节点">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Elasticsearch-2" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/24/Elasticsearch-2/" class="article-date">
  <time datetime="2017-08-24T06:00:28.000Z" itemprop="datePublished">2017-08-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/24/Elasticsearch-2/">Elasticsearch基础入门 2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>接着上一篇文章来学习稍微复杂一点的查询。</p>
<h2 id="使用查询表达式搜索"><a href="#使用查询表达式搜索" class="headerlink" title="使用查询表达式搜索"></a>使用查询表达式搜索</h2><p>Elasticsearch 提供一个丰富灵活的查询语言叫做<code>查询表达式</code>，它支持构建更加复杂和健壮的查询。</p>
<p><em>领域特定语言（DSL）</em>，指定了使用一个 JSON 请求。我们可以像这样重写之前的查询所有 Smith 的搜索：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /megacorp/employee/_search</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot; : &#123;</span><br><span class="line">        &quot;match&quot; : &#123;</span><br><span class="line">            &quot;last_name&quot; : &quot;Smith&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个请求使用 JSON 构造，并使用了一个 match 查询（属于查询类型之一，后续将会了解）。</p>
<h2 id="更复杂的搜索"><a href="#更复杂的搜索" class="headerlink" title="更复杂的搜索"></a>更复杂的搜索</h2><p>搜索姓氏为Smith 的雇员，并且年龄大于30的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">GET /megacorp/employee/_search</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot; : &#123;</span><br><span class="line">        &quot;bool&quot;: &#123;</span><br><span class="line">            &quot;must&quot;: &#123;</span><br><span class="line">                &quot;match&quot; : &#123;</span><br><span class="line">                    &quot;last_name&quot; : &quot;smith&quot; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;filter&quot;: &#123;</span><br><span class="line">                &quot;range&quot; : &#123;</span><br><span class="line">                    &quot;age&quot; : &#123; &quot;gt&quot; : 30 &#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目前无需太多担心语法问题，后续会更详细地介绍。只需明确我们添加了一个 过滤器 用于执行一个范围查询，并复用之前的 match 查询。由于现在的查询请求JSON 太长了，直接在终端使用curl 输入将十分麻烦，所以我们可以使用Kibana 的 Console来进行查询。如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/rason/rason.github.io/master/image/elasticsearch-search.png" alt="复杂查询"></p>
<p>现在结果只返回了一个雇员，叫 Jane Smith，32 岁。</p>
        
          <p class="article-more-link">
            <a href="/2017/08/24/Elasticsearch-2/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/08/24/Elasticsearch-2/" data-id="cjs45t43p0018fn9fux0o4tbs" class="article-share-link" data-share="baidu" data-title="Elasticsearch基础入门 2">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Elasticsearch-1" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/24/Elasticsearch-1/" class="article-date">
  <time datetime="2017-08-24T02:52:45.000Z" itemprop="datePublished">2017-08-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/24/Elasticsearch-1/">Elasticsearch基础入门 1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前使用ELK将日志系统初步搭建了起来，但是对于Elasticsearch的查询语法还是有点陌生，所以就要针对性地学习一下。</p>
<h2 id="与Elasticsearch-进行交互"><a href="#与Elasticsearch-进行交互" class="headerlink" title="与Elasticsearch 进行交互"></a>与Elasticsearch 进行交互</h2><p>Elasticsearch 的安装和运行之前已经介绍过了，现在就直接学习怎么通过HTTP和Elasticsearch 进行交互。</p>
<p>Elasticsearch 请求格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X&lt;VERB&gt; &apos;&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;&apos; -d &apos;&lt;BODY&gt;&apos;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>部件</th>
<th>解析</th>
</tr>
</thead>
<tbody>
<tr>
<td>VERB</td>
<td>适当的HTTP方法：GET,POST,PUT,HEAD或者DELETE</td>
</tr>
<tr>
<td>PROTOCOL</td>
<td>HTTP或者HTTPS</td>
</tr>
<tr>
<td>HOST</td>
<td>Elasticsearch 集群中任意节点的主机名</td>
</tr>
<tr>
<td>PORT</td>
<td>运行 Elasticsearch HTTP 服务的端口号，默认是 9200</td>
</tr>
<tr>
<td>PATH</td>
<td>API 的终端路径（例如 _count 将返回集群中文档数量）。Path 可能包含多个组件，例如：_cluster/stats 和 _nodes/stats/jvm</td>
</tr>
<tr>
<td>QUERY_STRING</td>
<td>任意可选的查询字符串参数 (例如 ?pretty 将格式化地输出 JSON 返回值，使其更容易阅读)</td>
</tr>
<tr>
<td>BODY</td>
<td>一个 JSON 格式的请求体 (如果请求需要的话)</td>
</tr>
</tbody>
</table>
<p>例如，计算集群中文档的数量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET &apos;http://localhost:9200/_count?pretty&apos; -d &apos;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">        &quot;match_all&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&apos;</span><br></pre></td></tr></table></figure>
<p>返回结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;count&quot; : 0,</span><br><span class="line">    &quot;_shards&quot; : &#123;</span><br><span class="line">        &quot;total&quot; : 5,</span><br><span class="line">        &quot;successful&quot; : 5,</span><br><span class="line">        &quot;failed&quot; : 0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在后面的内容中，我们将用缩写格式来展示这些 curl 示例，所谓的缩写格式就是省略请求中所有相同的部分，例如主机名、端口号以及 curl 命令本身。</p>
        
          <p class="article-more-link">
            <a href="/2017/08/24/Elasticsearch-1/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/08/24/Elasticsearch-1/" data-id="cjs45t43o0015fn9f8equ3pvj" class="article-share-link" data-share="baidu" data-title="Elasticsearch基础入门 1">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-elk" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/17/elk/" class="article-date">
  <time datetime="2017-08-17T07:33:59.000Z" itemprop="datePublished">2017-08-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/17/elk/">ELK日志监控系统</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>毫无疑问，日志对于开发者来说相当重要，通过日志可以追踪系统出现的问题和运行情况。</p>
<p>目前的工作依旧还是直接SSH登陆服务器，然后使用vim来查看日志，我觉得很麻烦，而且只能进行简单的问题跟踪，对日志数据的进一步分析相当困难。</p>
<p>通过搜索了解到ELK是比较流行的日志监控系统，所以就尝试着使用起来。</p>
<h2 id="ELK-stack"><a href="#ELK-stack" class="headerlink" title="ELK stack"></a>ELK stack</h2><p>ELK stack ：</p>
<ul>
<li><p><strong>L</strong>ogstash: 作为数据的收集引擎，从不同的地方收集数据并进行相应的处理，然后输送到存储引擎，比如ElasticSearch。</p>
</li>
<li><p><strong>E</strong>lasticSearch： 提供数据的存储和查询。ES提供全文搜索和分析，底层给予Lucene。默认就是分布式，易扩展。</p>
</li>
<li><p><strong>K</strong>ibana： 数据可视化工具，可以对ElasticSearch中的数据进行查询可视化。还可以进行分析和生成一些图表。</p>
</li>
</ul>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>从上面的介绍可知，使用ELK，我们可以通过一个Web界面来搜索分布式系统的日志数据。但更重要的是，我们还可以通过对数据的处理来对系统进行监控和调查分析。比如：</p>
<ul>
<li><p>统计某个类型的错误出现的次数</p>
</li>
<li><p>统计某个类型的事件数，以确定受问题影响的用户数量</p>
</li>
<li><p>升级系统之后产生的影响</p>
</li>
</ul>
<p>等等。</p>
<h2 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a>Logstash</h2><p>Logstash 作为中心的控制器和日志数据路由。</p>
<p>它可以从不同的数据源（使用<strong>input</strong>）对数据进行收集，然后使用<strong>filters</strong>对数据进行格式化等处理，最后数据流向各种输出端点（使用<strong>output</strong>）。如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/rason/rason.github.io/master/image/logstash.png" alt="Logstash"></p>
<p>因此，使用Logstash其实非常简单，就是通过一个配置文件（比如logstash.conf）来对数据管道中的三个部分（<strong>input - filter - output</strong>）进行配置即可。</p>
<h3 id="input"><a href="#input" class="headerlink" title="input"></a>input</h3><p>Logstash 可以通过不同的外部插件来从众多的数据源中接收数据，一些通用的比如“file”,”tcp/udp”，或者是一些其它的比如Kafka topic等。下面就是一个<strong>input</strong>配置的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">input &#123;  </span><br><span class="line">  tcp &#123;</span><br><span class="line">   port =&gt; 4560</span><br><span class="line">   codec =&gt; json_lines</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过上面的配置，应用系统就可以通过TCP连接Logstash服务器4560端口发送json格式的数据到Logstash中了。</p>
        
          <p class="article-more-link">
            <a href="/2017/08/17/elk/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/08/17/elk/" data-id="cjs45t48f00egfn9fhpu7w5vz" class="article-share-link" data-share="baidu" data-title="ELK日志监控系统">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ELK/">ELK</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-samza" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/02/hello-samza/" class="article-date">
  <time datetime="2017-08-02T06:09:37.000Z" itemprop="datePublished">2017-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/02/hello-samza/">Samza实时日志分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间初步研究了一下基于HDFS的离线日志分析，相应地自然会继续学习一下实时日志分析。实时分析最火的框架显然是Storm，但是在对比时发现Samza，据说跟Kafka结合的比较好，于是就先用Samza。以后有时间再研究Storm。</p>
<p>不过经过一番折腾，发现Samza的资料实在是太少了，期间遇到不少问题，断断续续花了几天的时间将官网的文档大概啃了一下。这故事告诉我们在技术选型的时候还是得选成熟，多用人的框架好，因为很多坑都被别人踩过一遍了。</p>
<h2 id="Samza入门"><a href="#Samza入门" class="headerlink" title="Samza入门"></a>Samza入门</h2><p>入门一个新框架的很好方法就是按照官网的示例走一遍。这里就不详细说了，可以见官网的<a href="http://samza.apache.org/startup/hello-samza/0.13/" target="_blank" rel="noopener">示例</a>。</p>
<h2 id="使用Samza统计实时PV"><a href="#使用Samza统计实时PV" class="headerlink" title="使用Samza统计实时PV"></a>使用Samza统计实时PV</h2><p>下面将介绍自己模仿官网示例做的一个小功能：统计公司官网一级菜单的实时PV。</p>
<h3 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h3><p>Samza通常要用到三个系统：<strong>YARN,Kafka,ZooKeeper</strong>。</p>
<p>Samza作业运行在YARN上，Kafka用于收集官网的实时Nginx访问日志，ZooKeeper用于协调Kafka集群。</p>
<p>这些环境的搭建都在前面的文章中介绍，本次的小功能也运行在之前搭建的环境上。</p>
<h3 id="整体运行流程"><a href="#整体运行流程" class="headerlink" title="整体运行流程"></a>整体运行流程</h3><ol>
<li>使用Flume采集Nginx日志信息，并且Sink到Kafka集群中的<code>qhee-net-access-log</code> Topic中。</li>
<li>定义一个继承于<code>StreamApplication</code>的Samza应用过滤<code>qhee-net-access-log</code> Topic中的无用日志信息，只留下一级菜单的访问日志，并输出到Kafka集群中的<code>nginx-access-log-output</code> Topic中。</li>
<li>定义另一个继承于<code>StreamApplication</code>的Samza应用读取<code>nginx-access-log-output</code> Topic中的消息，并统计某个时间段内的PV，然后输出到<code>qhee-pageview-output</code> Topic中。</li>
</ol>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><ul>
<li>Flume配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kafkaagent.sources = execSrc</span><br><span class="line">kafkaagent.channels = memoryChannel</span><br><span class="line">kafkaagent.sinks = kafkaSink</span><br><span class="line"></span><br><span class="line">kafkaagent.sources.execSrc.type = exec</span><br><span class="line">kafkaagent.sources.execSrc.command = tail -F /usr/local/nginx/logs/www.qhee.net.access.log</span><br><span class="line">kafkaagent.sources.execSrc.channels = memoryChannel</span><br><span class="line"></span><br><span class="line">kafkaagent.sinks.kafkaSink.type = org.apache.flume.sink.kafka.KafkaSink</span><br><span class="line">kafkaagent.sinks.kafkaSink.kafka.topic = qhee-net-access-log</span><br><span class="line">kafkaagent.sinks.kafkaSink.kafka.bootstrap.servers = kafka1:9092,kafka2:9092,kafka3:9092</span><br><span class="line">kafkaagent.sinks.kafkaSink.kafka.linger.ms = 1</span><br><span class="line">kafkaagent.sinks.kafkaSink.kafka.flumeBatchSize = 20</span><br><span class="line">kafkaagent.sinks.kafkaSink.channel = memoryChannel</span><br><span class="line"></span><br><span class="line">kafkaagent.channels.memoryChannel.type = memory</span><br><span class="line">kafkaagent.channels.memoryChannel.capacity = 1000</span><br><span class="line">kafkaagent.channels.memoryChannel.transactionCapacity = 100</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2017/08/02/hello-samza/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/08/02/hello-samza/" data-id="cjs45t48g00ejfn9fsr8dxcb8" class="article-share-link" data-share="baidu" data-title="Samza实时日志分析">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Samza/">Samza</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kafka-cluster-setup" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/12/kafka-cluster-setup/" class="article-date">
  <time datetime="2017-07-12T03:09:52.000Z" itemprop="datePublished">2017-07-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/12/kafka-cluster-setup/">Kafka集群搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在上一篇文章中我们已经搭建好了ZooKeeper集群，现在就可以开始搭建Kafka集群了。</p>
<p>Kafka的很多管理信息都放在ZooKeeper中，这是大规模分布式系统设计中常用的一种技巧，比如Storm也是采用类似的思路。通过这样的方式，代理服务器成为完全无状态的，无须记载任何状态信息，这样对于消息系统的容错性和可扩展性都有很大的好处。</p>
<p>Kafka使用ZooKeeper保存的管理信息和实现的功能包括：</p>
<ul>
<li><p>侦测代理服务器和消息消费者的动态加入和删除。</p>
</li>
<li><p>当动态加入或者删除代理服务器以及消息消费者后对消息系统进行负载均衡。</p>
</li>
<li><p>维护消费者和消息Topic以及数据分片的相互关系，并保存消费者当前读取消息的Offset。</p>
</li>
<li><p>数据副本管理信息。</p>
</li>
</ul>
<h2 id="Kafka安装"><a href="#Kafka安装" class="headerlink" title="Kafka安装"></a>Kafka安装</h2><h3 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载"></a>1. 下载</h3><p><a href="https://www.apache.org/dyn/closer.cgi?path=/kafka/0.11.0.0/kafka_2.11-0.11.0.0.tgz" target="_blank" rel="noopener">下载</a>最近的稳定版本，然后解压。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; tar -xzf kafka_2.11-0.11.0.0.tgz</span><br><span class="line">&gt; cd kafka_2.11-0.11.0.0</span><br></pre></td></tr></table></figure>
<h3 id="2-启动服务"><a href="#2-启动服务" class="headerlink" title="2. 启动服务"></a>2. 启动服务</h3><p>Kafka需要用到ZooKeeper，所以我们要先启动ZooKeeper服务。上篇文章中我们已经搭建好了ZooKeeper集群，继续沿用。</p>
<p>修改<code>conf/server.properties</code>文件zookeeper配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zookeeper.connect=zoo1:2181,zoo2:2181,zoo3:2181</span><br></pre></td></tr></table></figure>
<p>启动Kafka服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-server-start.sh config/server.properties</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">[2017-07-11 14:21:09,780] INFO [Kafka Server 0], started (kafka.server.KafkaServer)</span><br></pre></td></tr></table></figure>
<h3 id="创建一个Topic"><a href="#创建一个Topic" class="headerlink" title="创建一个Topic"></a>创建一个Topic</h3><p>创建一个只有一个分片和一个副本的<code>test</code> Topic用于测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test</span><br></pre></td></tr></table></figure>
<p>查看topic 列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-topics.sh --list --zookeeper localhost:2181</span><br><span class="line">test</span><br></pre></td></tr></table></figure>
<p>另外，我们也可以选择配置代理服务器向一个不存在的topic发送消息时自动创建topic。</p>
<h3 id="发送测试消息"><a href="#发送测试消息" class="headerlink" title="发送测试消息"></a>发送测试消息</h3><p>运行生产者然后在控制台输入一些消息发送到代理服务器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test</span><br><span class="line">This is a message</span><br><span class="line">This is another message</span><br></pre></td></tr></table></figure>
<h3 id="启动一个消费者"><a href="#启动一个消费者" class="headerlink" title="启动一个消费者"></a>启动一个消费者</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning</span><br><span class="line">This is a message</span><br><span class="line">This is another message</span><br></pre></td></tr></table></figure>
<p>如果你将上述命令都运行在不同的终端中，那么你现在应该可以在生产者终端中输入消息，并看到它们出现在消费者终端。</p>
<p>这些命令行工具都有可选参数，不加任何参数运行这些命令可以看到用法信息。</p>
        
          <p class="article-more-link">
            <a href="/2017/07/12/kafka-cluster-setup/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/07/12/kafka-cluster-setup/" data-id="cjs45t45s006yfn9fi6m7wjg6" class="article-share-link" data-share="baidu" data-title="Kafka集群搭建">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kafka/">Kafka</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-zookeeper-cluster-setup" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/11/zookeeper-cluster-setup/" class="article-date">
  <time datetime="2017-07-11T02:42:32.000Z" itemprop="datePublished">2017-07-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/11/zookeeper-cluster-setup/">ZooKeeper集群搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>将Flume事件存储在Kafka群中可以实现系统的高可用，Kafka需要用到ZooKeeper，因此我们需要先将ZooKeeper集群搭建起来。</p>
<p>ZooKeeper是一个开源的分布式协调系统。暴露简单的接口可以让我们来实现一些高级的功能，比如服务同步，配置管理，组管理和命名服务等。</p>
<p>关于ZooKeeper的应用场景和原理本文就不展开讨论，网上可以搜到很多信息，本文只介绍ZooKeeper集群的部署。</p>
<h2 id="单机模式"><a href="#单机模式" class="headerlink" title="单机模式"></a>单机模式</h2><p>搭建单机模式的ZooKeeper服务相当简单：</p>
<p>1.首先<a href="http://zookeeper.apache.org/releases.html" target="_blank" rel="noopener">下载</a>一个稳定的版本，然后解压。</p>
<p>2.在ZooKeeper跟目录下创建<code>conf/zoo.cfg</code>文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">dataDir=/var/lib/zookeeper</span><br><span class="line">clientPort=2181</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>tickTime</strong> ： 基本时间单元，以毫秒为单位。用于心跳检测，也就是每个tickTime就会发送一个心跳。</li>
<li><strong>dataDir</strong> ： 保存内存快照数据的位置。</li>
<li><strong>clientPort</strong> ： 监听客户端连接的端口。</li>
</ul>
<p>3.启动ZooKeeper</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh start</span><br></pre></td></tr></table></figure>
<p>我们可以在根目录<code>zookeeper.out</code>文件中看到启动日志。</p>
<h2 id="管理ZooKeeper存储"><a href="#管理ZooKeeper存储" class="headerlink" title="管理ZooKeeper存储"></a>管理ZooKeeper存储</h2><p>现在，我们可以简单地测试一下ZooKeeper的存储。</p>
<h3 id="连接到ZooKeeper"><a href="#连接到ZooKeeper" class="headerlink" title="连接到ZooKeeper"></a>连接到ZooKeeper</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/zkCli.sh -server 127.0.0.1:2181</span><br></pre></td></tr></table></figure>
<p>控制台可以看到一些输出信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Connecting to 127.0.0.1:2181</span><br><span class="line">2017-07-10 15:54:33,803 - INFO  [main:Environment@97] - Client environment:zookeeper.version=3.3.6-1366786, built on 07/29/2012 06:22 GMT</span><br><span class="line">...</span><br><span class="line">Welcome to ZooKeeper!</span><br><span class="line">JLine support is enabled</span><br></pre></td></tr></table></figure>
<p>接着输入<code>help</code>命令可以看到一些使用介绍：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ZooKeeper -server host:port cmd args</span><br><span class="line">	stat path [watch]</span><br><span class="line">	set path data [version]</span><br><span class="line">	ls path [watch]</span><br><span class="line">	delquota [-n|-b] path</span><br><span class="line">	ls2 path [watch]</span><br><span class="line">	setAcl path acl</span><br><span class="line">	setquota -n|-b val path</span><br><span class="line">	history </span><br><span class="line">	redo cmdno</span><br><span class="line">	printwatches on|off</span><br><span class="line">	delete path [version]</span><br><span class="line">	sync path</span><br><span class="line">	listquota path</span><br><span class="line">	get path [watch]</span><br><span class="line">	create [-s] [-e] path data acl</span><br><span class="line">	addauth scheme auth</span><br><span class="line">	quit </span><br><span class="line">	getAcl path</span><br><span class="line">	close </span><br><span class="line">	connect host:port</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2017/07/11/zookeeper-cluster-setup/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/07/11/zookeeper-cluster-setup/" data-id="cjs45t466007ufn9f5rdkww7q" class="article-share-link" data-share="baidu" data-title="ZooKeeper集群搭建">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ZooKeeper/">ZooKeeper</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pig-and-hive" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/07/pig-and-hive/" class="article-date">
  <time datetime="2017-07-07T05:20:19.000Z" itemprop="datePublished">2017-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BigData/">BigData</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/07/pig-and-hive/">使用Pig结构化日志然后导入到Hive数据仓库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>接着上篇文章，我们已经将日志通过Flume收集到了HDFS中，那么接下来就是使用Pig将日志内容结构化，然后保存到Hive数据仓库中。</p>
<h2 id="Pig安装"><a href="#Pig安装" class="headerlink" title="Pig安装"></a>Pig安装</h2><p>1.下载最近稳定版的Pig,<a href="http://hadoop.apache.org/pig/releases.html" target="_blank" rel="noopener">点这里</a>.</p>
<p>2.解压，修改<code>/etc/profile</code>文件配置环境变量<code>$ export PATH=/&lt;my-path-to-pig&gt;/pig-n.n.n/bin:$PATH</code></p>
<p>3.<code>$ source /etc/profile</code>使环境变量生效</p>
<p>4.测试安装是否成功<code>$ pig -help</code></p>
<h2 id="运行Pig"><a href="#运行Pig" class="headerlink" title="运行Pig"></a>运行Pig</h2><p>本例子接着之前的教程，前提需要已经部署好的Hadoop并且配置好其环境变量。</p>
<p>1.运行Pig</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pig</span><br></pre></td></tr></table></figure>
<p>2.进入HDFS文件系统根目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt&gt; cd hdfs://10.16.1.24/</span><br></pre></td></tr></table></figure>
<p>该目录是我前面教程中搭建的HDFS文件系统根目录。</p>
<p>3.查看根目录有哪些文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grunt&gt; ls</span><br><span class="line">hdfs://10.16.1.24/flume	&lt;dir&gt;</span><br><span class="line">hdfs://10.16.1.24/output	&lt;dir&gt;</span><br><span class="line">hdfs://10.16.1.24/test	&lt;dir&gt;</span><br><span class="line">hdfs://10.16.1.24/tmp	&lt;dir&gt;</span><br><span class="line">hdfs://10.16.1.24/user	&lt;dir&gt;</span><br></pre></td></tr></table></figure>
<p>上篇文章中通过Flume收集的日志在<code>/flume</code>文件夹中。</p>
<p>4.结构化日志文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grunt&gt; content = LOAD &apos;/flume/qhee/net/*&apos; USING PigStorage(&apos;\t&apos;) AS(domain:chararray,host:chararray,user:chararray,time:chararray,method:chararray,path:chararray,protocol:chararray,status:chararray,size:chararray,refer:chararray,agent:chararray,response_time:chararray,cookie:chararray,set_cookie:chararray,upstream_addr:chararray,upstream_cache_status:chararray,upstream_reponse_time:chararray);</span><br><span class="line"></span><br><span class="line">grunt&gt; DUMP content;</span><br><span class="line"></span><br><span class="line">grunt&gt; STORE content INTO &apos;output&apos; USING PigStorage (&apos;,&apos;);</span><br></pre></td></tr></table></figure>
<p>相关命令解析就不展开了，可以自行查看官方文档。</p>
<p>结构化之后的日志保存到了<code>output</code>目录中，所以上面的HDFS根目录中会有<code>output</code>这个文件夹，因为我之前已经执行过了。</p>
<p>可以将结构化的文件下载下来看看结果，发现其实就是将每个属性用逗号隔开了而已。做这项工作的主要目的就是为了方便导入到Hive仓库中，后面将会看到我们会以逗号为分隔符导入。</p>
<p>接下来该轮到Hive登场了。</p>
        
          <p class="article-more-link">
            <a href="/2017/07/07/pig-and-hive/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2017/07/07/pig-and-hive/" data-id="cjs45t45x0078fn9fj0b34u0y" class="article-share-link" data-share="baidu" data-title="使用Pig结构化日志然后导入到Hive数据仓库">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pig/">Pig</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AMQP/">AMQP</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Architecture/">Architecture</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BigData/">BigData</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Business/">Business</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Concurrency/">Concurrency</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataBase/">DataBase</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPattern/">DesignPattern</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed/">Distributed</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-Web/">Java Web</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">SpringBoot</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringCloud/">SpringCloud</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thought/">Thought</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a><span class="category-list-count">7</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOP/">AOP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adapter-Decorator/">Adapter Decorator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Architecture/">Architecture</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bean/">Bean</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BeanDefinitionRegistryPostProcessor/">BeanDefinitionRegistryPostProcessor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binary-Tree/">Binary Tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ClassLoader/">ClassLoader</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ClassPath/">ClassPath</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Command-Chain-of-Responsibility/">Command Chain of Responsibility</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrency/">Concurrency</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consensus/">Consensus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Container-Lifecycle/">Container Lifecycle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie-and-Session/">Cookie and Session</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Curator/">Curator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/">ELK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Facade-Observer/">Facade Observer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Filter/">Filter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flume/">Flume</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gitlab-Jenkins/">Gitlab Jenkins</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git内部原理/">Git内部原理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git分支/">Git分支</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/">Hadoop</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HighMemery/">HighMemery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hystrix/">Hystrix</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IO/">IO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOC容器/">IOC容器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA线程池/">JAVA线程池</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-Encoding/">Java Encoding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaBean转Xml/">JavaBean转Xml</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins-Tomcat/">Jenkins Tomcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/">Kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LKM/">LKM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux内存/">Linux内存</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux命令/">Linux命令</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVCC/">MVCC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/">Network</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Partition/">Partition</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pig/">Pig</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/">RabbitMQ</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raft/">Raft</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RestTemplate/">RestTemplate</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ribbon/">Ribbon</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Samza/">Samza</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Serialization/">Serialization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ServletContext-ServletConfig/">ServletContext ServletConfig</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot-MySQL/">SpringBoot MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot-缓存/">SpringBoot 缓存</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/">SpringCloud</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/">SpringMVC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring基本结构/">Spring基本结构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Strategy-Proxy/">Strategy Proxy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Synchronized/">Synchronized</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thought/">Thought</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thrift/">Thrift</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat-NIO/">Tomcat NIO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat-Servlet-Interface/">Tomcat Servlet Interface</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat-find-Servlet/">Tomcat find Servlet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat架构/">Tomcat架构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web请求/">Web请求</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZooKeeper/">ZooKeeper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zuul/">Zuul</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/distributed-session/">distributed-session</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git分支管理/">git分支管理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git远程仓库/">git远程仓库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml转javabean/">xml转javabean</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/三方存管/">三方存管</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二叉查找树/">二叉查找树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/任务列表/">任务列表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/优先队列-Algorithm/">优先队列 Algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态代理/">动态代理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/地址空间/">地址空间</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/子数组的最大值-Kadane算法/">子数组的最大值 Kadane算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符设备驱动/">字符设备驱动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发编程/">并发编程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/总结/">总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排序/">排序</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/操作系统/">操作系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/散列表/">散列表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件系统/">文件系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/私募债/">私募债</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/符号表/">符号表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/虚拟内存/">虚拟内存</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/进程和线程/">进程和线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/页面置换算法/">页面置换算法</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AOP/" style="font-size: 10px;">AOP</a> <a href="/tags/Adapter-Decorator/" style="font-size: 10px;">Adapter Decorator</a> <a href="/tags/Algorithm/" style="font-size: 18px;">Algorithm</a> <a href="/tags/Architecture/" style="font-size: 20px;">Architecture</a> <a href="/tags/Bean/" style="font-size: 10px;">Bean</a> <a href="/tags/BeanDefinitionRegistryPostProcessor/" style="font-size: 10px;">BeanDefinitionRegistryPostProcessor</a> <a href="/tags/Binary-Tree/" style="font-size: 10px;">Binary Tree</a> <a href="/tags/ClassLoader/" style="font-size: 14px;">ClassLoader</a> <a href="/tags/ClassPath/" style="font-size: 10px;">ClassPath</a> <a href="/tags/Command-Chain-of-Responsibility/" style="font-size: 10px;">Command Chain of Responsibility</a> <a href="/tags/Concurrency/" style="font-size: 12px;">Concurrency</a> <a href="/tags/Consensus/" style="font-size: 10px;">Consensus</a> <a href="/tags/Container-Lifecycle/" style="font-size: 10px;">Container Lifecycle</a> <a href="/tags/Cookie-and-Session/" style="font-size: 10px;">Cookie and Session</a> <a href="/tags/Curator/" style="font-size: 10px;">Curator</a> <a href="/tags/Django/" style="font-size: 14px;">Django</a> <a href="/tags/ELK/" style="font-size: 10px;">ELK</a> <a href="/tags/Elasticsearch/" style="font-size: 14px;">Elasticsearch</a> <a href="/tags/Facade-Observer/" style="font-size: 10px;">Facade Observer</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Flume/" style="font-size: 12px;">Flume</a> <a href="/tags/Gitlab-Jenkins/" style="font-size: 10px;">Gitlab Jenkins</a> <a href="/tags/Git内部原理/" style="font-size: 10px;">Git内部原理</a> <a href="/tags/Git分支/" style="font-size: 10px;">Git分支</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Hadoop/" style="font-size: 12px;">Hadoop</a> <a href="/tags/HighMemery/" style="font-size: 10px;">HighMemery</a> <a href="/tags/Hystrix/" style="font-size: 10px;">Hystrix</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/IOC容器/" style="font-size: 10px;">IOC容器</a> <a href="/tags/JAVA线程池/" style="font-size: 10px;">JAVA线程池</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Java-Encoding/" style="font-size: 10px;">Java Encoding</a> <a href="/tags/JavaBean转Xml/" style="font-size: 10px;">JavaBean转Xml</a> <a href="/tags/Jenkins-Tomcat/" style="font-size: 10px;">Jenkins Tomcat</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/LKM/" style="font-size: 10px;">LKM</a> <a href="/tags/Linux/" style="font-size: 16px;">Linux</a> <a href="/tags/Linux内存/" style="font-size: 10px;">Linux内存</a> <a href="/tags/Linux命令/" style="font-size: 10px;">Linux命令</a> <a href="/tags/MVCC/" style="font-size: 10px;">MVCC</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Network/" style="font-size: 20px;">Network</a> <a href="/tags/Partition/" style="font-size: 10px;">Partition</a> <a href="/tags/Pig/" style="font-size: 10px;">Pig</a> <a href="/tags/RabbitMQ/" style="font-size: 20px;">RabbitMQ</a> <a href="/tags/Raft/" style="font-size: 10px;">Raft</a> <a href="/tags/RestTemplate/" style="font-size: 10px;">RestTemplate</a> <a href="/tags/Ribbon/" style="font-size: 10px;">Ribbon</a> <a href="/tags/Samza/" style="font-size: 10px;">Samza</a> <a href="/tags/Serialization/" style="font-size: 10px;">Serialization</a> <a href="/tags/ServletContext-ServletConfig/" style="font-size: 10px;">ServletContext ServletConfig</a> <a href="/tags/SpringBoot/" style="font-size: 12px;">SpringBoot</a> <a href="/tags/SpringBoot-MySQL/" style="font-size: 10px;">SpringBoot MySQL</a> <a href="/tags/SpringBoot-缓存/" style="font-size: 10px;">SpringBoot 缓存</a> <a href="/tags/SpringCloud/" style="font-size: 14px;">SpringCloud</a> <a href="/tags/SpringMVC/" style="font-size: 12px;">SpringMVC</a> <a href="/tags/Spring基本结构/" style="font-size: 10px;">Spring基本结构</a> <a href="/tags/Strategy-Proxy/" style="font-size: 10px;">Strategy Proxy</a> <a href="/tags/Synchronized/" style="font-size: 10px;">Synchronized</a> <a href="/tags/Thought/" style="font-size: 10px;">Thought</a> <a href="/tags/Thrift/" style="font-size: 14px;">Thrift</a> <a href="/tags/Tomcat-NIO/" style="font-size: 10px;">Tomcat NIO</a> <a href="/tags/Tomcat-Servlet-Interface/" style="font-size: 10px;">Tomcat Servlet Interface</a> <a href="/tags/Tomcat-find-Servlet/" style="font-size: 10px;">Tomcat find Servlet</a> <a href="/tags/Tomcat架构/" style="font-size: 10px;">Tomcat架构</a> <a href="/tags/Web请求/" style="font-size: 10px;">Web请求</a> <a href="/tags/ZooKeeper/" style="font-size: 10px;">ZooKeeper</a> <a href="/tags/Zuul/" style="font-size: 10px;">Zuul</a> <a href="/tags/distributed-session/" style="font-size: 10px;">distributed-session</a> <a href="/tags/git分支管理/" style="font-size: 10px;">git分支管理</a> <a href="/tags/git远程仓库/" style="font-size: 10px;">git远程仓库</a> <a href="/tags/xml转javabean/" style="font-size: 10px;">xml转javabean</a> <a href="/tags/三方存管/" style="font-size: 10px;">三方存管</a> <a href="/tags/二叉查找树/" style="font-size: 10px;">二叉查找树</a> <a href="/tags/任务列表/" style="font-size: 10px;">任务列表</a> <a href="/tags/优先队列-Algorithm/" style="font-size: 10px;">优先队列 Algorithm</a> <a href="/tags/动态代理/" style="font-size: 10px;">动态代理</a> <a href="/tags/地址空间/" style="font-size: 10px;">地址空间</a> <a href="/tags/子数组的最大值-Kadane算法/" style="font-size: 10px;">子数组的最大值 Kadane算法</a> <a href="/tags/字符设备驱动/" style="font-size: 10px;">字符设备驱动</a> <a href="/tags/并发编程/" style="font-size: 10px;">并发编程</a> <a href="/tags/总结/" style="font-size: 10px;">总结</a> <a href="/tags/排序/" style="font-size: 16px;">排序</a> <a href="/tags/操作系统/" style="font-size: 10px;">操作系统</a> <a href="/tags/散列表/" style="font-size: 10px;">散列表</a> <a href="/tags/文件系统/" style="font-size: 10px;">文件系统</a> <a href="/tags/私募债/" style="font-size: 10px;">私募债</a> <a href="/tags/符号表/" style="font-size: 10px;">符号表</a> <a href="/tags/虚拟内存/" style="font-size: 12px;">虚拟内存</a> <a href="/tags/进程和线程/" style="font-size: 10px;">进程和线程</a> <a href="/tags/页面置换算法/" style="font-size: 10px;">页面置换算法</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/12/Raft/">Raft</a>
          </li>
        
          <li>
            <a href="/2017/12/05/Data-Partition/">Data Partition</a>
          </li>
        
          <li>
            <a href="/2017/11/30/MVCC/">MVCC</a>
          </li>
        
          <li>
            <a href="/2017/11/23/Http-Request-Method/">Http Request Method</a>
          </li>
        
          <li>
            <a href="/2017/11/06/io-model/">I/O Model</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 rason<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="totop"><img src="/img/scrollup.png"></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js"></script>

</div>
</body>
</html>
